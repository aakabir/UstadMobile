(function() {
    var languages = ['css', 'php', 'html', 'javascript'];

    tinymce.PluginManager.add( 'prism', function( editor ){

        var items = [];

        tinymce.each( languages, function( languageName ){
            items.push({
                text: languageName,
                onclick: function(){
                    var content = tinyMCE.activeEditor.selection.getContent();
                    editor.insertContent( '<pre><code class="language-' + languageName + '">' + content + '</code></pre>' );
                }
            });
        });

        editor.addButton( 'prism', {
            type: 'menubutton',
            text: 'Prism',
            icon: 'code',
            menu: items
        });

    });
})();