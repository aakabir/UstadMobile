//apply plugin: 'java-library'
apply plugin: 'java'
apply plugin: "maven-publish"


dependencies {
    compile fileTree(dir: 'libs', include: ['*.jar'])
    compile project(':lib-database-runtime')
    compile "org.jboss.forge.roaster:roaster-api:2.19.4.Final"
    compile "org.jboss.forge.roaster:roaster-jdt:2.19.4.Final"
    compile "commons-io:commons-io:$version_commons_io"

    testCompile "junit:junit:$version_junit"
}

task sourceJar(type: Jar) {
    from sourceSets.main.allJava
}

task runRoomProcessor(type: JavaExec) {
    inputs.files("../lib-database-entities/src/main/java/com/ustadmobile/lib/db/entities/*.java")
    classpath sourceSets.main.runtimeClasspath
    main = "com.ustadmobile.lib.dbprocessor.EntityProcessorRoom"
    args "../lib-database-entities/src/main/java/com/ustadmobile/lib/db/entities", "../lib-database-android/build/generated/source/umentities/com/ustadmobile/lib/db/entities"
}

sourceCompatibility = "1.8"
targetCompatibility = "1.8"

publishing {
    publications {
        maven(MavenPublication) {
            groupId rootProject.group
            artifactId project.name
            version rootProject.version

            from components.java

            artifact sourceJar {
                classifier = 'sources'
            }
        }
    }

    repositories {
        maven {
            url rootProject.ext.buildConfigProperties['repo.dir']
        }
    }
}